NineNineFreelas.utils.MessageUtils=function(){function a(){function a(){function a(a){d||b.attr("data-original",b.attr("href")),b.attr("href",v+"/images/main-icons/"+a)}var b=$("link[rel~='icon']"),d=b.attr("data-original"),e=A.getNewMessages(),f=A.getNewMessagesDispute(),g=e||f,h=A.getNewNotifications();g?($("title").text("("+g+") "+c),a("message.svg")):($("title").text(c),h?a("notification.svg"):d&&(b.attr("href",d),b.attr("data-original","")))}function d(){y()&&B(function(){var a=v+"/sounds/notification.mp3",b=new Audio(a);b.play().then(function(){w&&console.info("beep",(new Date).toLocaleTimeString())}).catch(function(a){w&&console.info("User has not interacted with document yet.",a)})})}function e(a){$(a).removeClass("show")}function f(a,b,c,d){if($generalMsgBox=$(a),b&&($generalMsgBox.find(".content").remove(),c||(c=""),$generalMsgBox.append('<div class="content '+c+'">'+b+"</div>")),$content=$generalMsgBox.find(".content"),$content.length>0){$generalMsgBox.addClass("show");var f=5e3;$content.hasClass("more-time")&&(f=1e4),$content.hasClass("less-time")&&(f=3e3),$content.hasClass("infinite-time")&&(f=-1);var g=function(){e(a),d&&d()};f>0&&setTimeout(g,f),$generalMsgBox.find(".close").click(g)}}function g(a){a&&a.msgBox&&(e(a.msgBox),a.msgBox+=a.msg||a.specific?".specific":".default",f(a.msgBox,a.msg,a.timeClass,a.fnActionClose))}function h(a,b){g({msgBox:".general-msg-box.with-action."+a,specific:!0,msg:null,fnActionClose:b})}function i(a){g({msgBox:".general-msg-box.success",specific:!0,msg:a})}function j(a){g({msgBox:".general-msg-box.error",specific:!0,msg:a,timeClass:"infinite-time"})}function k(){g({msgBox:".general-msg-box.error",specific:!1})}function l(a){a&&a.elemId&&a.msg&&($("#"+a.elemId).addClass("input-error"),$("#"+a.elemId+"-error-msg").css("display","block"),$("#"+a.elemId+"-error-msg .error-msg").html(a.msg))}function m(a){$(a.contexto+" .input-error-msg").hide(),$(a.contexto+" .input-error").removeClass("input-error")}function n(a,b){if(a&&a.length){for(var c="",d=0;d<a.length;d++){var e=a[d];e&&e.msg&&(c+="<li>"+e.msg+"</li>")}c&&(c="<p><b>Por favor, corrija o seguinte: </b></p><ul>"+c+"</ul>",p(c,b))}}function o(a){$(a.contexto+" .general-error-msg").hide()}function p(a,b){if(a)if(b=x.defineDefault(b,{contexto:"",goToTop:!0,generalErrorMsgForFail:!1}),b.generalErrorMsgForFail)j(a);else{var c=$(b.contexto+" .general-error-msg");c.length>0&&(c.html(a),c.linkify(),c.show(),b.goToTop&&$("html, body").animate({scrollTop:c.offset().top},500))}}function q(a){a=x.defineDefault(a,{contexto:""}),m(a),o(a)}function r(a,b){if(b=x.defineDefault(b,{msgFalhaIndividual:!0,msgFalhaGeral:!0,contexto:""}),q(b),a&&a.length>0){if(b.msgFalhaIndividual)for(var c=0;c<a.length;c++)l(a[c]);b.msgFalhaGeral&&!b.generalErrorMsgForFail&&n(a,b)}}function s(){var a=!!t(window.location,"success");if(a)i();else{var b=!!t(window.location,"e");b&&j()}}function t(a,b){for(var c=a.search.substring(1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]===b)return f[1]}}function u(){b.getNewMessages=A.getNewMessages,b.defineNewMessages=A.defineNewMessages,b.getNewMessagesDispute=A.getNewMessagesDispute,b.defineNewMessagesDispute=A.defineNewMessagesDispute,b.getNewNotifications=A.getNewNotifications,b.defineNewNotifications=A.defineNewNotifications,b.notify=C.notify,b.updateTitle=a,b.beep=d,b.verifyMessage=s,b.exibirMsgWithAction=h,b.exibirMsgSucesso=i,b.exibirMsgErro=j,b.exibirMsgErroPadrao=k,b.mostrarFalhas=r,b.exibirMensagemDeFalhaGeral=p,b.esconderMensagensDeFalha=q}var v=NineNineFreelas.constants.Urls.RESOURCES_BASE_PATH,w=NineNineFreelas.constants.General.DEV_SERVER,x=NineNineFreelas.prepare(NineNineFreelas.utils.ServiceUtils),y=function(){var a=!1;return $("body").one("keypress click touchend",function(){a=!0}),function(){return a}}(),z=function(a,b){var c=function(c){if(localStorage){var d=localStorage.getItem(a),e=(new Date).getTime(),f=""+e+"-"+1e3*Math.random(),g=!d,h=(d||"").split("-")[0],i=parseInt(h||0)+(b||100),j=e>i;if(g||j){localStorage.setItem(a+"-tmp",f);var k=localStorage.getItem(a),l=!1;if(k===d){localStorage.setItem(a,f);var m=localStorage.getItem(a+"-tmp");l=m===f}l&&setTimeout(function(){return localStorage.getItem(a)===f?c&&c():void 0},200)}}};return c},A=function(){function a(){return g}function b(a){"0"===a&&(a=null),g=a}function c(){return i}function d(a){"0"===a&&(a=null),i=a}function e(){return h}function f(a){"0"===a&&(a=null),h=a}var g=null,h=null,i=null;return{getNewMessages:a,defineNewMessages:b,getNewMessagesDispute:c,defineNewMessagesDispute:d,getNewNotifications:e,defineNewNotifications:f}}(),B=z("beep",3e3),C=function(){if(x)return{notify:function(){}};var a=z("notified",3e3);if(!Notification)return console.log("Desktop notifications not available in your browser. Try Chromium."),void 0;"granted"!==Notification.permission&&Notification.requestPermission().catch(function(a){w&&console.log("notification permission denied",a)});var b=function(b,c,d){"granted"===Notification.permission&&a(function(){var a=new Notification(b,{icon:v+"/images/main-icons/favicon-32x32.png",body:c,requireInteraction:!0});w&&console.log("notification created",(new Date).toLocaleTimeString()),a.onclick=function(){window.open(d||window.location.origin)}})};return{notify:b}}();u()}var b={},c=$("title").text();return b.prepare=function(){return b.prepare=function(){return b},a(),b},b}();